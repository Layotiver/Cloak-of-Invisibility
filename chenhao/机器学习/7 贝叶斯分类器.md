# 7 贝叶斯分类器
## 7.1 贝叶斯决策论
- 期望损失
$$ R(c_i|\mathbf x)=\sum_{j=1}^N \lambda_{ij}P(c_j|\mathbf x) $$
- 总体风险
$$ R(h)=E_\mathbf x[R(h(\mathbf x)|\mathbf x)]$$
- 贝叶斯判定准则
为了最小化总体风险，只需在每个样本上选择能使条件风险$R(c|\mathbf x)$最小的类别标记
从而需要获得后验概率。

- 估计后验概率的两种策略
1. 判别式模型：给定x，直接建模p(c|x)。之前章节学习的算法都是这种模型。
2. 生成式模型：对联合发布P(x,c)建模，由此获得P(c|x)

- 对于生成式模型，问题转化为估计P(c)和P(x|c)
P(c)可通过各样本出现的频率来估计。

## 7.2 极大似然估计
- 假设P(x|c)有确定的分布形式，被参数向量$\theta_c$确定
然后跟概统学的差不多，乘起来取对数。

## 7.3 朴素贝叶斯分类器
- 属性条件独立性假设
假设每个属性独立地对分类结果产生影响
$$ P(\mathbf x|c)=\prod_{i=1}^d P(x_i|c)$$
$$ P(x_i|c)=\frac{|D_{c,x_i}|}{|D_c|} $$
- 拉普拉斯修正
$$ P(x_i|c)=\frac{|D_{c,x_i}|+1}{|D_c|+N_i} $$
$N_i$为第i个属性可能的取值数

## 7.4 半朴素贝叶斯分类器
- 最常用策略：独依赖估计
关键：确定每个属性的父属性
1. SPODE：所有属性都依赖于一个父属性，即”超父“
2. TAN：计算两两属性之间的“条件互信息” p171，生成完全图，取最大生成树
3. AODE：将每个属性作为超父构建SPODE，然后将具有足够训练数据支撑（某个属性值出现的次数大于一个阈值）的SPODE集成起来 p172

## 7.5 贝叶斯网
- 组成
一个贝叶斯网由结构$G$和参数$\Theta$组成。
$G$为有向无环图
$\Theta$包含了每个属性的条件概率表

### 7.5.1 结构
- 假设每个属性与非后裔属性独立
从而可得属性的联合发布 p173

- 生成道德图以判定条件独立性 p174

### 7.5.2 学习
- 用评分函数评估贝叶斯网与训练数据的契合程度
$$ s(B|D)=f(\theta)|B|-LL(B|D) $$
### 7.5.3 推断
- 通过贝叶斯网的联合概率计算后验分布是NP难的，因此需要“近似推断”，如吉布斯采样。

## 7.6 EM算法
- EM交替 p179
E：以当前参数估计隐变量的期望或概率分布
M：基于已观测变量和已求的隐变量发布求参数的极大似然。

